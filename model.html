<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D 嵌瓷群组预览 - 哈基米南北绿队实验室</title>
    <style>
        body { margin: 0; background: radial-gradient(circle, #1a1a1a, #000); overflow: hidden; font-family: sans-serif; }
        #canvas-container { width: 100vw; height: 100vh; }
        .ui-overlay { position: absolute; top: 20px; left: 20px; color: white; pointer-events: none; }
        .back-btn { 
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            padding: 12px 25px; background: #ff4b1f; color: white; border-radius: 25px;
            text-decoration: none; font-weight: bold; pointer-events: auto;
            transition: 0.3s;
        }
        .back-btn:hover { background: #ff6a45; }
    </style>
</head>
<body>

    <div class="ui-overlay">
        <h2>3D 数字孪生档案 </h2>
        <p>操作说明：左键旋转 | 右键平移 | 滚轮缩放</p>
    </div>

    <a href="index.html" class="back-btn">返回主页</a>

    <div id="canvas-container"></div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OBJLoader } from 'three/addons/loaders/OBJLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // --- 1. 初始化场景 ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // --- 2. 灯光配置 ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);
        
        const mainLight = new THREE.DirectionalLight(0xffffff, 1.5);
        mainLight.position.set(5, 10, 7.5);
        scene.add(mainLight);

        // 补光，让侧面更清晰
        const backLight = new THREE.PointLight(0xffffff, 1);
        backLight.position.set(-5, -2, -5);
        scene.add(backLight);

        const controls = new OrbitControls(camera, renderer.domElement);
        camera.position.set(0, 3, 8); // 视角稍微拉远一点以容纳三个模型
        controls.update();

        // --- 3. 材质定义 ---
        const porcelainMaterial = new THREE.MeshStandardMaterial({
            color: 0xffffff,      
            roughness: 0.1,      
            metalness: 0.2,      
            side: THREE.DoubleSide 
        });

        // --- 4. 多模型加载逻辑 ---
        const loader = new OBJLoader();
        
        // 在这里定义你的模型路径和位置
        const modelConfigs = [
            { path: '001.obj', xOffset: -4 }, // 左边
            { path: 'second.obj', xOffset: 0 },  // 中间
            { path: 'third.obj', xOffset: 4 }   // 右边
        ];

        modelConfigs.forEach(config => {
            loader.load(
                config.path,
                (object) => {
                    object.traverse((child) => {
                        if (child.isMesh) {
                            child.material = porcelainMaterial;
                        }
                    });

                    // 居中处理
                    const box = new THREE.Box3().setFromObject(object);
                    const center = box.getCenter(new THREE.Vector3());
                    object.position.sub(center); 

                    // 设置模型在场景中的位置
                    object.position.x += config.xOffset;
                    
                    scene.add(object);
                    console.log(`${config.path} 加载成功！`);
                },
                (xhr) => { console.log(`${config.path}: ${(xhr.loaded / xhr.total * 100).toFixed(2)}%`); },
                (error) => { console.error(`${config.path} 加载出错：`, error); }
            );
        });

        // --- 5. 动画循环 ---
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        // --- 6. 响应式调整 ---
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>